{% extends "clinica/base.html" %}

{% block content %}
<h3 class="mb-4">
    üìÜ Agenda da semana ({{ hoje|date:"d/m" }} a {{ fim_semana|date:"d/m" }})
</h3>

{% if agendamentos %}

<div class="table-responsive">  <!-- üîπ ADICIONADO -->
<table class="table table-bordered table-sm">
    <thead class="table-light">
        <tr>
            <th>Data</th>
            <th>Hor√°rio</th>
            <th>Paciente</th>
            <th>Servi√ßo</th>
            <th>Profissional</th>
            <th style="min-width:140px;">A√ß√µes</th> <!-- üîπ pequena prote√ß√£o -->
        </tr>
    </thead>
    <tbody>
    {% for a in agendamentos %}
        <tr>
            <td>{{ a.data|date:"d/m/Y" }}</td>
            <td>{{ a.horario|time:"H:i" }}</td>
            <td>{{ a.paciente.nome }}</td>
            <td>{{ a.servico }}</td>
            <td>{{ a.profissional }}</td>
            <td>
                {% if perms.agendamentos.gerenciar_agendamentos %}
                    <a href="{% url 'agendamento_edit' a.id %}" 
                       class="btn btn-sm btn-warning">
                        ‚úèÔ∏è Editar
                    </a>

                    <form action="{% url 'agendamento_delete' a.id %}"
                          method="post"
                          style="display:inline;"
                          onsubmit="return confirm('Deseja realmente excluir este agendamento?')">
                        {% csrf_token %}
                        <button class="btn btn-sm btn-danger">
                            Excluir
                        </button>
                    </form>
                {% else %}
                    <span class="text-muted">Somente leitura</span>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
</div> <!-- üîπ ADICIONADO -->

{% else %}
<p class="text-muted">Nenhum agendamento para esta semana.</p>
{% endif %}

<a href="{% url 'clinica_dashboard' %}" class="btn btn-secondary mt-3">
    ‚¨Ö Voltar ao dashboard
</a>
{% endblock %}
